YUI.add("console",function(r,t){var e=r.ClassNameManager.getClassName,s="checked",n="clear",i="click",o="collapsed",l="console",a="contentBox",c="disabled",u="entry",h="error",_="height",g="info",d="lastTime",f="pause",p="paused",v="reset",C="startTime",L="title",b="warn",m=".",y=e(l,"button"),E=e(l,"checkbox"),T=e(l,n),S=e(l,"collapse"),w=e(l,o),A=e(l,"controls"),H=e(l,"hd"),M=e(l,"bd"),O=e(l,"ft"),P=e(l,L),B=e(l,u),R=e(l,u,"cat"),U=e(l,u,"content"),x=e(l,u,"meta"),k=e(l,u,"src"),N=e(l,u,"time"),I=e(l,f),D=e(l,f,"label"),F=/^(\S+)\s/,V=/&(?!#?[a-z0-9]+;)/g,z=/>/g,Y=/</g,G='<div class="{entry_class} {cat_class} {src_class}"><p class="{entry_meta_class}"><span class="{entry_src_class}">{sourceAndDetail}</span><span class="{entry_cat_class}">{category}</span><span class="{entry_time_class}"> {totalTime}ms (+{elapsedTime}) {localTime}</span></p><pre class="{entry_content_class}">{message}</pre></div>',W=r.Lang,j=r.Node.create,e=W.isNumber,q=W.isString,$=r.merge,J=r.Lang.sub;function K(){K.superclass.constructor.apply(this,arguments)}r.Console=r.extend(K,r.Widget,{_evtCat:null,_head:null,_body:null,_foot:null,_printLoop:null,buffer:null,log:function(){return r.log.apply(r,arguments),this},clearConsole:function(){return this._body.empty(),this._cancelPrintLoop(),this.buffer=[],this},reset:function(){return this.fire(v),this},collapse:function(){return this.set(o,!0),this},expand:function(){return this.set(o,!1),this},printBuffer:function(t){var e,s=this.buffer,i=r.config.debug,n=[],o=this.get("consoleLimit"),l=this.get("newestOnTop"),a=l?this._body.get("firstChild"):null;if(s.length>o&&s.splice(0,s.length-o),t=Math.min(s.length,t||s.length),r.config.debug=!1,!this.get(p)&&this.get("rendered")){for(e=0;e<t&&s.length;++e)n[e]=this._createEntryHTML(s.shift());s.length||this._cancelPrintLoop(),n.length&&(l&&n.reverse(),this._body.insertBefore(j(n.join("")),a),this.get("scrollIntoView")&&this.scrollToLatest(),this._trimOldEntries())}return r.config.debug=i,this},initializer:function(){this._evtCat=r.stamp(this)+"|",this.buffer=[],this.get("logSource").on(this._evtCat+this.get("logEvent"),r.bind("_onLogEvent",this)),this.publish(u,{defaultFn:this._defEntryFn}),this.publish(v,{defaultFn:this._defResetFn}),this.after("rendered",this._schedulePrint)},destructor:function(){var t=this.get("boundingBox");this._cancelPrintLoop(),this.get("logSource").detach(this._evtCat+"*"),t.purge(!0)},renderUI:function(){this._initHead(),this._initBody(),this._initFoot();var t=this.get("style");"block"!==t&&this.get("boundingBox").addClass(this.getClassName(t))},syncUI:function(){this._uiUpdatePaused(this.get(p)),this._uiUpdateCollapsed(this.get(o)),this._uiSetHeight(this.get(_))},bindUI:function(){this.get(a).one("button."+S).on(i,this._onCollapseClick,this),this.get(a).one("input[type=checkbox]."+I).on(i,this._onPauseClick,this),this.get(a).one("button."+T).on(i,this._onClearClick,this),this.after(this._evtCat+"stringsChange",this._afterStringsChange),this.after(this._evtCat+"pausedChange",this._afterPausedChange),this.after(this._evtCat+"consoleLimitChange",this._afterConsoleLimitChange),this.after(this._evtCat+"collapsedChange",this._afterCollapsedChange)},_initHead:function(){var t=this.get(a),e=$(K.CHROME_CLASSES,{str_collapse:this.get("strings.collapse"),str_title:this.get("strings.title")});this._head=j(J(K.HEADER_TEMPLATE,e)),t.insertBefore(this._head,t.get("firstChild"))},_initBody:function(){this._body=j(J(K.BODY_TEMPLATE,K.CHROME_CLASSES)),this.get(a).appendChild(this._body)},_initFoot:function(){var t=$(K.CHROME_CLASSES,{id_guid:r.guid(),str_pause:this.get("strings.pause"),str_clear:this.get("strings.clear")});this._foot=j(J(K.FOOTER_TEMPLATE,t)),this.get(a).appendChild(this._foot)},_isInLogLevel:function(t){var e=t.cat,t=this.get("logLevel");return t===g||!((e=q(e=e||g)?e.toLowerCase():e)===b&&t===h||e===g&&t!==g)},_normalizeMessage:function(t){var e=t.msg,s=t.cat,t=t.src,t={time:new Date,message:e,category:s||this.get("defaultCategory"),sourceAndDetail:t||this.get("defaultSource"),source:null,localTime:null,elapsedTime:null,totalTime:null};return t.source=F.test(t.sourceAndDetail)?RegExp.$1:t.sourceAndDetail,t.localTime=t.time.toLocaleTimeString?t.time.toLocaleTimeString():t.time+"",t.elapsedTime=t.time-this.get(d),t.totalTime=t.time-this.get(C),this._set(d,t.time),t},_schedulePrint:function(){this._printLoop||this.get(p)||!this.get("rendered")||(this._printLoop=r.later(this.get("printTimeout"),this,this.printBuffer,this.get("printLimit"),!0))},_createEntryHTML:function(s){return s=$(this._htmlEscapeMessage(s),K.ENTRY_CLASSES,{cat_class:this.getClassName(u,s.category),src_class:this.getClassName(u,s.source)}),this.get("entryTemplate").replace(/\{(\w+)\}/g,function(t,e){return e in s?s[e]:""})},scrollToLatest:function(){var t=this.get("newestOnTop")?0:this._body.get("scrollHeight");this._body.set("scrollTop",t)},_htmlEscapeMessage:function(t){return t.message=this._encodeHTML(t.message),t.source=this._encodeHTML(t.source),t.sourceAndDetail=this._encodeHTML(t.sourceAndDetail),t.category=this._encodeHTML(t.category),t},_trimOldEntries:function(){r.config.debug=!1;var t,e,s,i,n=this._body,o=this.get("consoleLimit"),l=r.config.debug;if(n&&0<(i=(t=n.all(m+B)).size()-o)){for(this.get("newestOnTop")?(s=o,i=t.size()):s=0,this._body.setStyle("display","none");s<i;++s)(e=t.item(s))&&e.remove();this._body.setStyle("display","")}r.config.debug=l},_encodeHTML:function(t){return q(t)?t.replace(V,"&#38;").replace(Y,"&#60;").replace(z,"&#62;"):t},_cancelPrintLoop:function(){this._printLoop&&(this._printLoop.cancel(),this._printLoop=null)},_validateStyle:function(t){return"inline"===t||"block"===t||"separate"===t},_onPauseClick:function(t){this.set(p,t.target.get(s))},_onClearClick:function(t){this.clearConsole()},_onCollapseClick:function(t){this.set(o,!this.get(o))},_validateLogSource:function(t){return t&&r.Lang.isFunction(t.on)},_setLogLevel:function(t){return(t=q(t)?t.toLowerCase():t)===b||t===h?t:g},
_getUseBrowserConsole:function(){var t=this.get("logSource");return t instanceof YUI?t.config.useBrowserConsole:null},_setUseBrowserConsole:function(t){var e=this.get("logSource");return e instanceof YUI?e.config.useBrowserConsole=t=!!t:r.Attribute.INVALID_VALUE},_uiSetHeight:function(t){var e;K.superclass._uiSetHeight.apply(this,arguments),this._head&&this._foot&&(e=this.get("boundingBox").get("offsetHeight")-this._head.get("offsetHeight")-this._foot.get("offsetHeight"),this._body.setStyle(_,e+"px"))},_uiSizeCB:function(){},_afterStringsChange:function(t){var e=t.subAttrName?t.subAttrName.split(m)[1]:null,s=this.get(a),i=t.prevVal,t=t.newVal;e&&e!==L||i.title===t.title||s.all(m+P).setHTML(t.title),e&&e!==f||i.pause===t.pause||s.all(m+D).setHTML(t.pause),e&&e!==n||i.clear===t.clear||s.all(m+T).set("value",t.clear)},_afterPausedChange:function(t){var e=t.newVal;t.src!==r.Widget.SRC_UI&&this._uiUpdatePaused(e),e?this._printLoop&&this._cancelPrintLoop():this._schedulePrint()},_uiUpdatePaused:function(t){var e=this._foot.all("input[type=checkbox]."+I);e&&e.set(s,t)},_afterConsoleLimitChange:function(){this._trimOldEntries()},_afterCollapsedChange:function(t){this._uiUpdateCollapsed(t.newVal)},_uiUpdateCollapsed:function(t){var e=this.get("boundingBox"),s=e.all("button."+S),i=t?"addClass":"removeClass",n=this.get("strings."+(t?"expand":"collapse"));e[i](w),s&&s.setHTML(n),this._uiSetHeight(t?this._head.get("offsetHeight"):this.get(_))},_afterVisibleChange:function(t){K.superclass._afterVisibleChange.apply(this,arguments),this._uiUpdateFromHideShow(t.newVal)},_uiUpdateFromHideShow:function(t){t&&this._uiSetHeight(this.get(_))},_onLogEvent:function(t){var e;!this.get(c)&&this._isInLogLevel(t)&&(e=r.config.debug,r.config.debug=!1,this.fire(u,{message:this._normalizeMessage(t)}),r.config.debug=e)},_defResetFn:function(){this.clearConsole(),this.set(C,new Date),this.set(c,!1),this.set(p,!1)},_defEntryFn:function(t){t.message&&(this.buffer.push(t.message),this._schedulePrint())}},{NAME:l,LOG_LEVEL_INFO:g,LOG_LEVEL_WARN:b,LOG_LEVEL_ERROR:h,ENTRY_CLASSES:{entry_class:B,entry_meta_class:x,entry_cat_class:R,entry_src_class:k,entry_time_class:N,entry_content_class:U},CHROME_CLASSES:{console_hd_class:H,console_bd_class:M,console_ft_class:O,console_controls_class:A,console_checkbox_class:E,console_pause_class:I,console_pause_label_class:D,console_button_class:y,console_clear_class:T,console_collapse_class:S,console_title_class:P},HEADER_TEMPLATE:'<div class="{console_hd_class}"><h4 class="{console_title_class}">{str_title}</h4><button type="button" class="{console_button_class} {console_collapse_class}">{str_collapse}</button></div>',BODY_TEMPLATE:'<div class="{console_bd_class}"></div>',FOOTER_TEMPLATE:'<div class="{console_ft_class}"><div class="{console_controls_class}"><label class="{console_pause_label_class}"><input type="checkbox" class="{console_checkbox_class} {console_pause_class}" value="1" id="{id_guid}"> {str_pause}</label><button type="button" class="{console_button_class} {console_clear_class}">{str_clear}</button></div></div>',ENTRY_TEMPLATE:G,ATTRS:{logEvent:{value:"yui:log",writeOnce:!0,validator:q},logSource:{value:r,writeOnce:!0,validator:function(t){return this._validateLogSource(t)}},strings:{valueFn:function(){return r.Intl.get("console")}},paused:{value:!1,validator:W.isBoolean},defaultCategory:{value:g,validator:q},defaultSource:{value:"global",validator:q},entryTemplate:{value:G,validator:q},logLevel:{value:r.config.logLevel||g,setter:function(t){return this._setLogLevel(t)}},printTimeout:{value:100,validator:e},printLimit:{value:50,validator:e},consoleLimit:{value:300,validator:e},newestOnTop:{value:!0},scrollIntoView:{value:!0},startTime:{value:new Date},lastTime:{value:new Date,readOnly:!0},collapsed:{value:!1},height:{value:"300px"},width:{value:"300px"},useBrowserConsole:{lazyAdd:!1,value:!1,getter:function(){return this._getUseBrowserConsole()},setter:function(t){return this._setUseBrowserConsole(t)}},style:{value:"separate",writeOnce:!0,validator:function(t){return this._validateStyle(t)}}}})},"@VERSION@",{requires:["yui-log","widget"],skinnable:!0,lang:["en","es","hu","it","ja"]});